local lunatest = package.loaded.lunatest
local glhash = GLunaTestLib.hash

local suite = {}

lunatest.add_tests_by_table(suite, "crc32", {
	{"", "00000000"},
	{"a", "E8B7BE43"},
	{"some test string", "44A923AE"},

	{"abc", "352441C2"},
	{"123456", "0972D361"},
	{"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "171A3F5F"},
	{"abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu", "191F3349"},
	{"asdf", "5129F3BD"},

	{"The quick brown fox jumps over the lazy dog", "414FA339"},
	{"The quick brown fox jumps over the lazy dog.", "519025E9"},
	{"Hello, World!", "EC4AC3D0"},

	{('0'):rep(50), "E26A1DD3"},
	{('0'):rep(70), "1991EE3D"},
	{('1'):rep(824), "6AB4593D"},
	{('1'):rep(1528), "5E0C81D4"},
	{('a'):rep(55), "AADFE34E"},
	{('a'):rep(56), "79790D37"},

	{"00000000", "C0088D03"},
	{"C850C0E5CA49A663", "F0BBB60E"},
	{"85CCC97CF2905418", "8D777CF7"},
	{"85CCC97CF2905418C850C0E5CA49A663", "A5943F32"},
	{"C850C0E5CA49A66385CCC97CF2905418", "702CC6EC"},
}, function(key, data, index)
	local input = data[1]
	local expected = data[2]

	local hash = glhash:CRC32_SUM(input)

	lunatest.assert_equal(expected, hash)
end)

lunatest.add_tests_by_table(suite, "md5", {
	{"", "D41D8CD98F00B204E9800998ECF8427E"},
	{"a", "0CC175B9C0F1B6A831C399E269772661"},
	{"test", "098F6BCD4621D373CADE4E832627B4F6"},
	{"some test string", "C320D73E0ECA9029AB6AB49C99E9795D"},

	{"abc", "900150983CD24FB0D6963F7D28E17F72"},
	{"123456", "E10ADC3949BA59ABBE56E057F20F883E"},
	{"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "8215EF0796A20BCAAAE116D3876C664A"},
	{"abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu", "03DD8807A93175FB062DFB55DC7D359C"},
	{"asdf", "912EC803B2CE49E4A541068D495AB570"},

	{"The quick brown fox jumps over the lazy dog", "9E107D9D372BB6826BD81D3542A419D6"},
	{"The quick brown fox jumps over the lazy dog.", "E4D909C290D0FB1CA068FFADDF22CBD0"},
	{"Hello, World!", "65A8E27D8879283831B664BD8B7F0AD4"},

	{('0'):rep(50), "86D2BFC0BAB44EECF21E1432BE7B3EFC"},
	{('0'):rep(70), "DE75F8071A40B6678E45B451D7E89CFB"},
	{('1'):rep(824), "A126FD3611AB8D9B7E8A3384E2FA78A0"},
	{('1'):rep(1528), "3750B6A29D923B633E05D6AE76895664"},
	{('a'):rep(55), "EF1772B6DFF9A122358552954AD0DF65"},
	{('a'):rep(56), "3B0C8AC703F828B04C6C197006D17218"},

	{"00000000", "DD4B21E9EF71E1291183A46B913AE6F2"},
	{"C850C0E5CA49A663", "3FFAA733CE5C76E52645AE68B0464364"},
	{"85CCC97CF2905418", "60F943F95D4E27B322F5856A6B1136D5"},
	{"85CCC97CF2905418C850C0E5CA49A663", "ADD1F29FCCA086C03F53AAC58A761D4E"},
	{"C850C0E5CA49A66385CCC97CF2905418", "512933C4A232242F536A5670239FA51A"},
}, function(key, data, index)
	local input = data[1]
	local expected = data[2]

	local hash = glhash:MD5_SUM(input)

	lunatest.assert_equal(expected, hash)
end)

lunatest.add_tests_by_table(suite, "sha256", {
	{"", "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855"},
	{"a", "CA978112CA1BBDCAFAC231B39A23DC4DA786EFF8147C4E72B9807785AFEE48BB"},
	{"test", "9F86D081884C7D659A2FEAA0C55AD015A3BF4F1B2B0B822CD15D6C15B0F00A08"},
	{"some test string", "F1EBECBFFECF3F8E4F60DB92DE00B600EE7B695C30F255463D55B36BA4AE35D6"},

	{"abc", "BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD"},
	{"123456", "8D969EEF6ECAD3C29A3A629280E686CF0C3F5D5A86AFF3CA12020C923ADC6C92"},
	{"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "248D6A61D20638B8E5C026930C3E6039A33CE45964FF2167F6ECEDD419DB06C1"},
	{"abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu", "CF5B16A778AF8380036CE59E7B0492370B249B11E8F07A51AFAC45037AFEE9D1"},
	{"asdf", "F0E4C2F76C58916EC258F246851BEA091D14D4247A2FC3E18694461B1816E13B"},

	{"The quick brown fox jumps over the lazy dog", "D7A8FBB307D7809469CA9ABCB0082E4F8D5651E46D3CDB762D02D0BF37C9E592"},
	{"The quick brown fox jumps over the lazy dog.", "EF537F25C895BFA782526529A9B63D97AA631564D5D789C2B765448C8635FB6C"},
	{"Hello, World!", "DFFD6021BB2BD5B0AF676290809EC3A53191DD81C7F70A4B28688A362182986F"},

	{('0'):rep(50), "7080233A6A52652793AB110F0ADD9E76CA602D6967E93A30F25528E9FA5C58AE"},
	{('0'):rep(70), "3A82A2F228264303E7BA1C33D44E99740CE445BB3DCB206DCF23D140C6D59370"},
	{('1'):rep(824), "B6DE92A412FFEC7C6F0AAC60A32214AAD8F39E0061CE36E159A16D61AC8FB4D6"},
	{('1'):rep(1528), "7392DC683760AB15622B95137B08F4ECECA79AD49C672271E39CBCB7DBB3BF53"},
	{('a'):rep(55), "9F4390F8D30C2DD92EC9F095B65E2B9AE9B0A925A5258E241C9F1E910F734318"},
	{('a'):rep(56), "B35439A4AC6F0948B6D6F9E3C6AF0F5F590CE20F1BDE7090EF7970686EC6738A"},

	{"00000000", "7E071FD9B023ED8F18458A73613A0834F6220BD5CC50357BA3493C6040A9EA8C"},
	{"C850C0E5CA49A663", "063EDDB18AF1614C9DE5B8A939D8DE968F988068DDCCBA27C0A9DCB5F0076942"},
	{"85CCC97CF2905418", "8008CDE01C230246C8B559B2ADEF49C04333D58254B6A2AAF6FA64BD9CC7F034"},
	{"85CCC97CF2905418C850C0E5CA49A663", "9C84A21BC16A63F73DF2B78EEDA70C45A9DDEE2E58A7B109320AB028C3026F33"},
	{"C850C0E5CA49A66385CCC97CF2905418", "DE79B86094DFB0CDA0082CF07F3BA3496BE69C32C597576C923C5726541C5DE8"},
}, function(key, data, index)
	local input = data[1]
	local expected = data[2]

	local hash = glhash:SHA256_SUM(input)

	lunatest.assert_equal(expected, hash)
end)

return suite

